DATABASE_URL=postgresql://kalshi@127.0.0.1:55432/kalshi
BACKUP_DATABASE_URL=postgresql://kalshi@127.0.0.1:55433/kalshi_backup
SERVICE_GUARDRAILS=1
SERVICE_ENV_GUARDRAILS=warn
# SERVICE_ENV_ALLOW_PREFIXES=DATABASE_URL_
# SERVICE_ENV_ALLOW_KEYS=AZURE_OPENAI_API_KEY
DB_INIT_SCHEMA=0
SERVICE_HEALTH_PORT=8101
LOG_LEVEL=INFO
LOG_DIR=/var/log/kalshi_ingestor
LOG_STDOUT=1
REST_FAILURE_THRESHOLD=5
REST_CIRCUIT_BREAKER_SECONDS=60

# Keep secrets scoped to this service (no RAG_* or Azure keys here).
KALSHI_HOST=https://api.elections.kalshi.com/trade-api/v2
KALSHI_API_KEY_ID=<kalshi-api-key-id>
KALSHI_PRIVATE_KEY_PEM_PATH=/path/to/kalshi_private_key.pem

STRIKE_PERIODS=hour,day,hourly,daily
DISCOVERY_EVENT_STATUSES=open,initialized
BACKFILL_EVENT_STATUSES=open

DISCOVERY_SECONDS=60
DISCOVERY_HEARTBEAT_SECONDS=60
DISCOVERY_UPDATED_SINCE_PARAM=updated_after_ts
BACKFILL_SECONDS=3600

CANDLE_MINUTES_FOR_HOUR=1
CANDLE_MINUTES_FOR_DAY=60
CANDLE_LOOKBACK_HOURS=168
# Shared REST rate limiter (db uses ingest_state for coordination).
KALSHI_REST_RATE_LIMIT_BACKEND=db
KALSHI_REST_RATE_PER_SEC=1
KALSHI_REST_BURST=2
KALSHI_REST_RATE_LIMIT_DB_URL=$DATABASE_URL
# Minimum seconds between candlestick API calls per worker (0 disables pacing)
KALSHI_CANDLE_MIN_INTERVAL_SECONDS=10.0

WORK_QUEUE_ENABLE=1
WORK_QUEUE_JOB_TYPES=backfill_market
WORK_QUEUE_NAME_BACKFILL_MARKET=kalshi.backfill
WORK_QUEUE_PUBLISH=1
RABBITMQ_URL=amqp://guest:guest@localhost:5672/
# Keep WORK_QUEUE_NAME aligned with the job-specific queue name.
WORK_QUEUE_NAME=kalshi.backfill
WORK_QUEUE_PREFETCH=4
WORK_QUEUE_POLL_SECONDS=10
WORK_QUEUE_RETRY_SECONDS=60
WORK_QUEUE_LOCK_TIMEOUT_SECONDS=900
WORK_QUEUE_MAX_ATTEMPTS=5
WORK_QUEUE_CLEANUP_HOURS=24

CLOSED_CLEANUP_SECONDS=3600
CLOSED_CLEANUP_EVENT_STATUSES=closed,settled
CLOSED_CLEANUP_GRACE_MINUTES=30
ARCHIVE_CLOSED_HOURS=24
ARCHIVE_REQUIRE_TERMINAL_LIFECYCLE=1
ARCHIVE_BATCH_SIZE=2000
